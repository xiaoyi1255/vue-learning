<template>
  <div class="vdom-container">
    <div class="header">
      <h1>Vue3 è™šæ‹ŸDOMå­¦ä¹ </h1>
      <p>æ·±å…¥ç†è§£Vue3è™šæ‹ŸDOMçš„è®¾è®¡åŸç†å’Œdiffç®—æ³•</p>
    </div>

    <div class="content">
      <div class="section">
        <h2>1. è™šæ‹ŸDOMåŸºç¡€æ¦‚å¿µ</h2>
        <div class="concept-card">
          <h3>ä»€ä¹ˆæ˜¯è™šæ‹ŸDOMï¼Ÿ</h3>
          <p>è™šæ‹ŸDOMæ˜¯å¯¹çœŸå®DOMçš„æŠ½è±¡è¡¨ç¤ºï¼Œæ˜¯ä¸€ä¸ªJavaScriptå¯¹è±¡ï¼Œæè¿°äº†çœŸå®DOMçš„ç»“æ„å’Œå±æ€§ã€‚</p>
          
          <div class="code-example">
            <h4>è™šæ‹ŸDOMç¤ºä¾‹ï¼š</h4>
            <pre><code>// è™šæ‹ŸDOMèŠ‚ç‚¹
const vnode = {
  type: 'div',
  props: { class: 'container' },
  children: [
    {
      type: 'h1',
      props: {},
      children: 'Hello Vue'
    }
  ]
}

// å¯¹åº”çš„çœŸå®DOM
&lt;div class="container"&gt;
  &lt;h1&gt;Hello Vue&lt;/h1&gt;
&lt;/div&gt;</code></pre>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>2. è™šæ‹ŸDOMçš„ä¼˜åŠ¿</h2>
        <div class="advantages-grid">
          <div class="advantage-card">
            <h3>ğŸš€ æ€§èƒ½ä¼˜åŒ–</h3>
            <p>é€šè¿‡diffç®—æ³•ï¼Œåªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†ï¼Œå‡å°‘DOMæ“ä½œæ¬¡æ•°</p>
          </div>
          <div class="advantage-card">
            <h3>ğŸ”„ è·¨å¹³å°</h3>
            <p>è™šæ‹ŸDOMå¯ä»¥æ¸²æŸ“åˆ°ä¸åŒå¹³å°ï¼ˆWebã€ç§»åŠ¨ç«¯ã€æ¡Œé¢ç«¯ï¼‰</p>
          </div>
          <div class="advantage-card">
            <h3>ğŸ§ª æ˜“äºæµ‹è¯•</h3>
            <p>è™šæ‹ŸDOMæ˜¯çº¯JavaScriptå¯¹è±¡ï¼Œä¾¿äºå•å…ƒæµ‹è¯•</p>
          </div>
          <div class="advantage-card">
            <h3>ğŸ¯ å£°æ˜å¼</h3>
            <p>å¼€å‘è€…åªéœ€è¦æè¿°æœŸæœ›çš„UIçŠ¶æ€ï¼Œæ¡†æ¶è´Ÿè´£DOMæ›´æ–°</p>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>3. Diffç®—æ³•åŸç†</h2>
        <div class="diff-cards">
          <div class="diff-card">
            <h3>åŒå±‚æ¯”è¾ƒ</h3>
            <p>Vue3çš„diffç®—æ³•é‡‡ç”¨åŒå±‚æ¯”è¾ƒç­–ç•¥ï¼Œä¸ä¼šè·¨å±‚çº§æ¯”è¾ƒèŠ‚ç‚¹</p>
            <div class="code-block">
              <pre><code>function patch(n1, n2, container) {
  // å¦‚æœæ–°æ—§èŠ‚ç‚¹ç±»å‹ä¸åŒï¼Œç›´æ¥æ›¿æ¢
  if (n1.type !== n2.type) {
    unmount(n1)
    mount(n2, container)
    return
  }
  
  // åŒç±»å‹èŠ‚ç‚¹ï¼Œæ›´æ–°å±æ€§
  patchProps(n1, n2)
  patchChildren(n1, n2, container)
}</code></pre>
            </div>
          </div>
          <div class="diff-card">
            <h3>å¿«é€ŸDiff</h3>
            <p>Vue3ä½¿ç”¨å¿«é€ŸDiffç®—æ³•ï¼Œé€šè¿‡keyä¼˜åŒ–åˆ—è¡¨æ›´æ–°æ€§èƒ½</p>
            <div class="code-block">
              <pre><code>function patchKeyedChildren(c1, c2, container) {
  // 1. ä»å¤´éƒ¨å¼€å§‹æ¯”è¾ƒ
  // 2. ä»å°¾éƒ¨å¼€å§‹æ¯”è¾ƒ  
  // 3. å¤„ç†æ–°å¢å’Œåˆ é™¤çš„èŠ‚ç‚¹
  // 4. ç§»åŠ¨å’Œå¤ç”¨èŠ‚ç‚¹
}</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>4. è™šæ‹ŸDOMå®ç°</h2>
        <div class="implementation-cards">
          <div class="impl-card">
            <h3>åˆ›å»ºè™šæ‹ŸDOM</h3>
            <p>hå‡½æ•°ç”¨äºåˆ›å»ºè™šæ‹ŸDOMèŠ‚ç‚¹</p>
            <div class="code-block">
              <pre><code>function h(type, props, children) {
  return {
    type,
    props: props || {},
    children: children || []
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const vnode = h('div', { class: 'app' }, [
  h('h1', null, 'Hello'),
  h('p', null, 'World')
])</code></pre>
            </div>
          </div>
          <div class="impl-card">
            <h3>æ¸²æŸ“è™šæ‹ŸDOM</h3>
            <p>renderå‡½æ•°å°†è™šæ‹ŸDOMæ¸²æŸ“ä¸ºçœŸå®DOM</p>
            <div class="code-block">
              <pre><code>function render(vnode, container) {
  if (typeof vnode === 'string') {
    container.textContent = vnode
    return
  }
  
  const el = document.createElement(vnode.type)
  
  // è®¾ç½®å±æ€§
  for (const key in vnode.props) {
    el.setAttribute(key, vnode.props[key])
  }
  
  // æ¸²æŸ“å­èŠ‚ç‚¹
  vnode.children.forEach(child => {
    render(child, el)
  })
  
  container.appendChild(el)
}</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>5. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h2>
        <div class="optimization-cards">
          <div class="opt-card">
            <h3>é™æ€æå‡</h3>
            <p>å°†é™æ€å†…å®¹æå‡åˆ°æ¸²æŸ“å‡½æ•°å¤–éƒ¨ï¼Œé¿å…é‡å¤åˆ›å»º</p>
          </div>
          <div class="opt-card">
            <h3>è¡¥ä¸æ ‡è®°</h3>
            <p>é€šè¿‡è¡¥ä¸æ ‡è®°ï¼ˆpatchFlagï¼‰æ ‡è¯†åŠ¨æ€å†…å®¹ï¼Œä¼˜åŒ–æ›´æ–°</p>
          </div>
          <div class="opt-card">
            <h3>æ ‘ç»“æ„ä¼˜åŒ–</h3>
            <p>è·³è¿‡é™æ€èŠ‚ç‚¹ï¼Œåªå¯¹åŠ¨æ€èŠ‚ç‚¹è¿›è¡Œdiff</p>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>6. å­¦ä¹ è¿›åº¦</h2>
        <div class="progress-info">
          <p>ğŸš§ è™šæ‹ŸDOMå­¦ä¹ æ¨¡å—æ­£åœ¨å¼€å‘ä¸­...</p>
          <p>é¢„è®¡åŒ…å«ï¼š</p>
          <ul>
            <li>è™šæ‹ŸDOMçš„åˆ›å»ºå’Œæ¸²æŸ“</li>
            <li>Diffç®—æ³•çš„è¯¦ç»†å®ç°</li>
            <li>Patchæ›´æ–°çš„è¿‡ç¨‹</li>
            <li>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</li>
            <li>æ‰‹å†™ç®€åŒ–ç‰ˆè™šæ‹ŸDOM</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
// è™šæ‹ŸDOMå­¦ä¹ é¡µé¢é€»è¾‘
</script>

<style scoped>
.vdom-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.header {
  text-align: center;
  margin-bottom: 3rem;
}

.header h1 {
  color: #2c3e50;
  margin-bottom: 1rem;
}

.header p {
  color: #666;
  font-size: 1.2rem;
}

.section {
  margin-bottom: 3rem;
}

.section h2 {
  color: #2c3e50;
  margin-bottom: 1.5rem;
  font-size: 1.8rem;
}

.concept-card {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.concept-card h3 {
  color: #42b883;
  margin-bottom: 1rem;
}

.code-example {
  margin-top: 1.5rem;
  background: #f8f9fa;
  border-radius: 8px;
  padding: 1.5rem;
}

.code-example h4 {
  margin-bottom: 1rem;
  color: #2c3e50;
}

.code-example pre {
  background: #2c3e50;
  color: #fff;
  padding: 1rem;
  border-radius: 6px;
  overflow-x: auto;
}

.advantages-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
}

.advantage-card {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.advantage-card h3 {
  color: #42b883;
  margin-bottom: 1rem;
  font-size: 1.2rem;
}

.advantage-card p {
  color: #666;
  line-height: 1.6;
}

.diff-cards {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
}

.diff-card {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.diff-card h3 {
  color: #42b883;
  margin-bottom: 1rem;
}

.diff-card p {
  color: #666;
  margin-bottom: 1.5rem;
  line-height: 1.6;
}

.code-block {
  background: #f8f9fa;
  border-radius: 8px;
  padding: 1rem;
}

.code-block pre {
  background: #2c3e50;
  color: #fff;
  padding: 1rem;
  border-radius: 6px;
  overflow-x: auto;
  font-size: 0.9rem;
}

.implementation-cards {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
}

.impl-card {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.impl-card h3 {
  color: #42b883;
  margin-bottom: 1rem;
}

.impl-card p {
  color: #666;
  margin-bottom: 1.5rem;
}

.optimization-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
}

.opt-card {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.opt-card h3 {
  color: #42b883;
  margin-bottom: 1rem;
}

.opt-card p {
  color: #666;
  line-height: 1.6;
}

.progress-info {
  background: #fff3cd;
  border: 1px solid #ffeaa7;
  border-radius: 12px;
  padding: 2rem;
  color: #856404;
}

.progress-info p {
  margin-bottom: 1rem;
}

.progress-info ul {
  margin-left: 1.5rem;
}

.progress-info li {
  margin-bottom: 0.5rem;
}

@media (max-width: 768px) {
  .diff-cards,
  .implementation-cards {
    grid-template-columns: 1fr;
  }
}
</style> 